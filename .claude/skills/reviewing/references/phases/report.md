# Phase 4: Report

Generate structured report and save to `.claude/.reviews/`.

## Steps

### 1. Mark Phase In Progress

- Update todo: mark Report as `in_progress`

### 2. Generate Report Filename

Format: `{YYMMDD}-{HHmm}-{scope}.md`

Examples:
- `260113-1430-staged.md`
- `260113-1430-pr-42.md`
- `260113-1430-branch-main.md`
- `260113-1430-commit-abc123.md`
- `260113-1430-files.md`
- `260113-1430-working.md`

### 3. Read Report Template

Read [report-template.md](../report-template.md) for the report structure.

### 4. Generate Report Content

Fill in template with review results:

```markdown
# Code Review Report

**Date**: {YYYY-MM-DD HH:MM}
**Scope**: {REVIEW_CONTEXT.description}
**Command**: `{REVIEW_CONTEXT.git_cmd}`

---

## Summary

{Overall assessment from reviewer verdict}

### Statistics

| Category | Count |
| -------- | ----- |
| Critical | {n}   |
| Warning  | {n}   |
| Info     | {n}   |

### Verdict

**{REVIEW_RESULTS.verdict}**

---

## Checklist

| Category       | Status |
| -------------- | ------ |
| Functionality  | {x/o}  |
| Readability    | {x/o}  |
| Security       | {x/o}  |
| Performance    | {x/o}  |
| Testing        | {x/o}  |
| Documentation  | {x/o}  |
| Architecture   | {x/o}  |
| Error Handling | {x/o}  |

(x = passed, o = issues found)

---

## Findings

### Critical Issues

{For each critical finding, format with conventional comment label}

### Warnings

{For each warning finding}

### Suggestions & Info

{For each info finding}

### Praise

{Any positive findings noted by reviewers}

---

## Dispatcher Decision

| Field     | Value                     |
| --------- | ------------------------- |
| Agent     | reviewer                  |
| Mode      | {single / parallel}       |
| Instances | {count}                   |
| Strategy  | {strategy}                |

---

## Review History

| Date       | Scope      | Verdict          | Report                   |
| ---------- | ---------- | ---------------- | ------------------------ |
| {today}    | {scope}    | {verdict}        | {this report}            |
| {previous} | {scope}    | {verdict}        | {previous report link}   |

---

_Generated by /review workflow_
```

### 5. Save Report

Write report to `.claude/.reviews/{filename}`:

```bash
mkdir -p .claude/.reviews
```

```
Write(
  file_path: ".claude/.reviews/{filename}",
  content: {report_content}
)
```

### 6. Update Review History (Optional)

If previous reviews exist for similar scope:
1. Read previous reports
2. Add comparison notes to current report
3. Highlight improvements or regressions

### 7. Present Summary to User

```
## Review Complete

**Report saved**: .claude/.reviews/{filename}

### Quick Summary

| Metric   | Value            |
| -------- | ---------------- |
| Scope    | {description}    |
| Verdict  | {verdict}        |
| Critical | {critical_count} |
| Warnings | {warning_count}  |
| Info     | {info_count}     |

### Top Issues

{List top 3 most important issues if any}

1. {issue 1 summary}
2. {issue 2 summary}
3. {issue 3 summary}

### Next Steps

{Based on verdict:}
- APPROVE: "Code looks good! Ready to merge."
- PASS WITH WARNINGS: "Consider addressing the warnings before merging."
- REQUEST CHANGES: "Please fix the critical issues before proceeding."
```

### 8. Mark Phase Complete

- Update todo: mark Report as `completed`
- Workflow complete

## Report Comparison (History Tracking)

When user requests comparison:

```
Compare current review with: .claude/.reviews/{previous_report}

Changes since last review:
- Critical issues: {diff}
- Warnings: {diff}
- Fixed issues: [list]
- New issues: [list]
```

## Finding Format Reference

Each finding in the report should follow this format:

```markdown
#### `issue (blocking):` {file_path}:{line_number}

**Issue**: {Description of the problem}

**Impact**: {Why this matters}

**Fix**:
```suggestion
{Code suggestion if applicable}
```
```

Reference: [comment-labels.md](../comment-labels.md) for all label formats.
